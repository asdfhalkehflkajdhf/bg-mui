<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>BoyG-活动编辑</title>
		<!-- // jquery -->
		<script src="../../res/js/jquery-3.3.1.min.js" type="text/javascript"></script>
		<!-- // axios 请求接口 -->
		<script src="../../res/axios-0.19.0/axios.min.js"  type="text/javascript"></script>
		<!-- // vue库 -->
		<script src="../../res/vue-2.6.7/vue.min.js" type="text/javascript"></script>
		<!-- // layer 弹出层 -->
		<!-- // http://layer.layui.com/ -->
		<script src="../../res/layer-v3.1.1/layer.js"></script>
		<link href="../../res/layer-v3.1.1/theme/default/layer.css" rel="stylesheet">
		<!-- bootstrap -->
		<link rel="stylesheet" href="../../res/bootstrap-4.0.0/css/bootstrap.min.css">
		<script src="../../res/bootstrap-4.0.0/js/bootstrap.min.js"></script>
		<link rel="stylesheet" type="text/css" href="../common/background-1.css">
		
		<!-- 自有资源 -->
		<link rel="stylesheet" type="text/css" href="./css/main.css">
		<!-- 编辑 -->
		<script type="text/javascript" src="../../res/wangEditor-3.1.1/wangEditor.min.js"></script>
		<link rel="stylesheet" href="../../res/wangEditor-3.1.1/wangEditor.min.css" type="text/css" />

	</head>
	<body>
		
		<div class="container ">
		    <div class="wrapper">
		
					<div class="group-item">
						<div class="card" style="">
							<div class="card-header">
								基本信息
							</div>
							<ul class="list-group list-group-flush">
								<li class="list-group-item">
									<div class="row">
										<div class="input-group col-sm">
											<div class="input-group-prepend">
												<span class="input-group-text" id="inputGroup-sizing-sm">标题</span>
											</div>
											<input type="text" class="form-control" aria-label="标题" aria-describedby="inputGroup-sizing-sm" 
											placeholder="必填项,最长128字符" required="required" maxlength="128">
										</div>
									</div>
								</li>
								<li class="list-group-item">

									<div class="row">
										<div class="input-group col-sm">
											<div class="input-group-prepend">
												<span class="input-group-text" id="inputGroup-sizing-sm">开始时间</span>
											</div>
											<input type="date" class="form-control" aria-label="开始时间" aria-describedby="inputGroup-sizing-sm" 
											placeholder="必填项,最长32字符" required="required" >
										</div>
										<div class="input-group col-sm">
											<div class="input-group-prepend">
												<span class="input-group-text" id="inputGroup-sizing-sm">结束时间</span>
											</div>
											<input type="date" class="form-control" aria-label="结束时间" aria-describedby="inputGroup-sizing-sm" 
											placeholder="必填项" required="required" >
										</div>
									</div>


								</li>
								<li class="list-group-item">
									
									<div class="row">
										<div class="input-group col-sm">
											<div class="input-group-prepend">
												<span class="input-group-text" id="inputGroup-sizing-sm">生活地</span>
											</div>
											<input type="text" class="form-control" aria-label="生活地" aria-describedby="inputGroup-sizing-sm" 
											placeholder="必填项" required="required" readonly="readonly" >
										</div>
										<div class="input-group col-sm">
											<div class="input-group-prepend">
												<span class="input-group-text" id="inputGroup-sizing-sm">人数</span>
											</div>
											<input type="number" class="form-control" aria-label="人数" aria-describedby="inputGroup-sizing-sm" 
											placeholder="必填项" required="required" maxlength="2">
											<div class="input-group-append">
												<span class="input-group-text">人</span>
											</div>
										</div>

										<div class="input-group col-sm">
											<div class="input-group-prepend">
												<span class="input-group-text" id="inputGroup-sizing-sm">平均开支</span>
											</div>
											<input type="number" class="form-control" aria-label="平均开支" aria-describedby="inputGroup-sizing-sm" 
											placeholder="必填项" required="required" >
											<div class="input-group-append">
												<span class="input-group-text">RMB</span>
											</div>
										</div>

									</div>
								</li>
								<li class="list-group-item">
									<div class="row">
										<!-- <div class="input-group col-sm">
											
										</div> -->
										<div class="input-group col-sm">
											<div class="input-group-prepend">
												<span class="input-group-text">活动首图</span>
											</div>
											<img src="css/200x200.svg" class="rounded float-left" alt="..." >
											<div class="custom-file">
												<input type="file" class="custom-file-input" ref="inputer" id="inputGroupFile01" v-on:change="readFile(this);">
												<label class="custom-file-label" for="inputGroupFile01" id="inputGroupFileLabel">选择文件</label>
											</div>
											<div class="input-group-append">
												<button class="btn btn-outline-secondary input-group-text" type="button" v-on:click="viewFirstPic()">预览</button>
											</div>
										</div>
										
									</div>
								</li>
								<li class="list-group-item">
									<div class="row">
										<div class="input-group col-sm">
											<div class="input-group-prepend">
												<span class="input-group-text" id="inputGroup-sizing-sm">活动简介</span>
											</div>
											<input type="text" class="form-control" aria-label="活动简介" aria-describedby="inputGroup-sizing-sm" 
											placeholder="必填项,最长128字符" required="required" maxlength="128">
										</div>

									</div>
								</li>
								
							</ul>
						</div>
						<div class="card" style="">
							<div class="card-header">
								活动详情 
								<button type="button" class="btn btn-outline-success text-center" v-on:click="viewActionInfo()">预览</button>
							</div>
							<div  class="card-header" id="actionMenu"></div>
							<div class="card-body" id="actionIntroduction">
								<!-- 个人介绍 -->
							</div>
							
							<div  class="placeholder-10"></div>
							<button type="button" class="btn btn-success text-center">发布</button>
							
						</div>
						
					</div>
	
					
			</div>
		</div>
		
	</body>
	
	<script>
		// 编辑框初始化
		var E = window.wangEditor;
		var editor_si = new E('#actionMenu','#actionIntroduction');
		editor_si.customConfig.uploadImgShowBase64 = true   // 使用 base64 保存图片
		editor_si.customConfig.uploadImgMaxSize = 3 * 1024 * 1024 // 将图片大小限制为 3M
		// editor_si.customConfig.uploadImgMaxLength = 1 // 限制一次最多上传 5 张图片

		// 创建编辑器之后，使用editor.txt.html(...)设置编辑器内容
		var editorMenus=[
		    'head',  // 标题
		    'bold',  // 粗体
		    'fontSize',  // 字号
		    // 'fontName',  // 字体
		    // 'italic',  // 斜体
		    'foreColor',  // 文字颜色
		    'backColor',  // 背景颜色
		    // 'link',  // 插入链接
		    'list',  // 列表
		    'justify',  // 对齐方式
		    'quote',  // 引用
		    // 'emoticon',  // 表情
		    'image',  // 插入图片
		    // 'table',  // 表格
		];
		// 自定义菜单配置
		editor_si.customConfig.menus =editorMenus;
		
		editor_si.create();
		
		const groupItem = new Vue({
			el: ".group-item",
			data:{
				title:"",
				startTime:"",
				endTime:"",
				placeLife:"",
				number:2,
				avgSpending:30,
				actFirstPic:"",
				actBrief:"",
				actDetails:""
			},
			created:function(){
				
			},
			methods:{
				readFile(obj){
					var _this = this
					var inputDOM = this.$refs.inputer;
					var file = inputDOM.files[0];
					if(file.size>2*1024*1024){
						layer.msg("文件不能超过2M");
						return false;
					}
					//这里我们判断下类型如果不是图片就返回 去掉就可以上传任意文件 
					if(!/image\/\w+/.test(file.type)){ 
						layer.msg("请确保文件为图像类型");
						return false; 
					}
					$("#inputGroupFileLabel").html(inputDOM.value);
					var reader = new FileReader(); 
					reader.readAsDataURL(file);
					reader.onload = function(e){
						_this.actFirstPic = this.result;
						// console.log(this.result);
						// result.innerHTML = '<img src="'+this.result+'" alt=""/>'; 
						// img_area.innerHTML = '<div class="sitetip">图片img标签展示：</div><img src="'+this.result+'" alt=""/>'; 
					} 
				},
				viewFirstPic(){

					if(this.actFirstPic.length==0){
						layer.msg("请先选择图片");
						return false;
					}
					
					var imgJson = {
					  "title": "", //相册标题
					  "id": 0, //相册id
					  "start": 0, //初始显示的图片序号，默认0
					  "data": [   //相册包含的图片，数组格式
						{
						  "alt": "",
						  "pid": 666, //图片id
						  "src": this.actFirstPic, //原图地址
						  "thumb": this.actFirstPic //缩略图地址
						}
					  ]
					};
					
					layer.photos({
						photos: imgJson
						//,anim: 2 //0-6的选择，指定弹出图片动画类型，默认随机（请注意，3.0之前的版本用shift参数）
					}); 
				},
				viewActionInfo(){
					layer.open({
						type: 1
						,title: '预览'
						,shade: false
						,area: ['100%', '100%']
						,scrollbar: false
						,content: '<div class="detail-body" style="margin:20px;">'+ editor_si.txt.html() +'</div>'
					});
				}
				
			}
		})
	

		
	</script>
	
</html>
