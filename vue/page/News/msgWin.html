<!DOCTYPE html>
<html tyle="height:100%">
	<head>
		<meta charset="utf-8">
		<!-- //允许网页宽度自动调整 -->
		<!-- //https://www.cnblogs.com/MissZhao/p/5773091.html -->
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>BogG-消息窗口</title>
		
		<!-- // jquery -->
		<script src="../../res/js/jquery-3.3.1.min.js" type="text/javascript"></script>
		<!-- // axios 请求接口 -->
		<script src="../../res/axios-0.19.0/axios.min.js"  type="text/javascript"></script>
		<!-- // vue库 -->
		<script src="../../res/vue-2.6.7/vue.min.js" type="text/javascript"></script>
		<!-- // layer 弹出层 -->
		<!-- // http://layer.layui.com/ -->
		<script src="../../res/layer-v3.1.1/layer.js"></script>
		<link href="../../res/layer-v3.1.1/theme/default/layer.css" rel="stylesheet">
		<!-- bootstrap -->
		<link rel="stylesheet" href="../../res/bootstrap-4.0.0/css/bootstrap.min.css">
		<script src="../../res/bootstrap-4.0.0/js/bootstrap.min.js"></script>
		<!-- 背景样式 -->
		<link rel="stylesheet" type="text/css" href="../common/background-1.css">
		
		<!-- 自有资源 -->
		<link rel="stylesheet" type="text/css" href="./css/msgWin.css">

		<!-- awesome图标 -->
		<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.css">

	</head>
	<body tyle="height:100%">
					<div class="card" style="height:100%;" id="msgWin">
						<div class="card-header" style="height:10%;">
							<!-- 消息内容窗口导航，关闭，删除，黑名单-->
							<button type="button" class="btn btn-outline-success">删除</button>
							<button type="button" class="btn btn-outline-success">添加到黑名单</button>
							
						</div>
						<div class="card-body" style="height:90%;" id="msgItemList">
							<!-- 消息内容样式 -->
							<div>
								<p class="text-center" style="color: #C8C8C8;">2019-03-19 12:00</p>
								<p class="text-left"><span class=" rounded " style="background-color: #E8E8E8;">关闭，删除，添加到黑名单</span></p>
							</div>
							<div>
								<p class="text-center" style="color: #C8C8C8;">2019-03-19 23:99</p>
								<p class="text-right"><span class=" rounded " style="background-color: #99CC66;">关闭，删除，添加到黑名单</span></p>
							</div>
							<div>
								<p class="text-center" style="color: #C8C8C8;">2019-03-19 99:44</p>
								<p class="text-right"><span class=" rounded " style="background-color: #99CC66;">This is some text within a card body.This is some text within a card body.This is some text within a card body.This is some text within a card body.This is some text within a card body.This is some text within a card body.This is some text within a card body.</span></p>
							</div>
							<div>
								<p class="text-center" style="color: #C8C8C8;">2019-03-19 12:00</p>
								<p class="text-left"><span class=" rounded " style="background-color: #E8E8E8;">关闭，删除，添加到黑名单</span></p>
							</div>
							<div>
								<p class="text-center" style="color: #C8C8C8;">2019-03-19 23:99</p>
								<p class="text-right"><span class=" rounded " style="background-color: #99CC66;">关闭，删除，添加到黑名单</span></p>
							</div>
							<div>
								<p class="text-center" style="color: #C8C8C8;">2019-03-19 12:00</p>
								<p class="text-left"><span class=" rounded " style="background-color: #E8E8E8;">关闭，删除，添加到黑名单</span></p>
							</div>
							<div>
								<p class="text-center" style="color: #C8C8C8;">2019-03-19 23:99</p>
								<p class="text-right"><span class=" rounded " style="background-color: #99CC66;">关闭，删除，添加到黑名单</span></p>
							</div>
							<div>
								<p class="text-center" style="color: #C8C8C8;">2019-03-19 99:44</p>
								<p class="text-right"><span class=" rounded " style="background-color: #99CC66;">This is some text within a card body.</span></p>
							</div>
							<div>
								<p class="text-center" style="">2019-03-19 12:00</p>
								<p class="text-left"><span class=" rounded " style="background-color: #E8E8E8;">关闭，删除，添加到黑名单</span></p>
							</div>
							<div>
								<p class="text-center" style="color: #C8C8C8;">2019-03-19 23:99</p>
								<p class="text-right"><span class=" rounded " style="background-color: #99CC66;">关闭，删除，添加到黑名单</span></p>
							</div>
						</div>
						<div class="card-footer" style="height:10%;">
							<!-- 消息内容发送 -->
							<div class="input-group" >
								<textarea class="form-control" aria-label="With textarea"></textarea>
								<div class="input-group-append">
									<button class="btn btn-outline-secondary" type="button">发送</span>
								</div>
							</div>
						</div>
					</div>
	</body>
	<script type="text/javascript">
		var msgWin = new Vue({
			el: "#msgWin",
			data:{
				
				msgLastTime:null
			},
			methods:{
				// 更新页面显示内容
				appendMsgWin:function(msgItem){
					var $container= $("#msgItemList");
					$.each(msgItem, function (i, data) {
						var $gitem = $(
							'<div>'
							+'	<p class="text-center msg-time-backcolor">'+data['time']+'</p>'
							+'	<p class="text-'+data['origin']+'"><span class="msg-text-backcolor-'+data['origin']+' rounded">'+data['content']+'</span></p>'
							+'</div>'
						);
						$container.append($gitem);
					});
					msgItem=[];
				},
				//获取数据请求
				upMsgWin:function(){
					var _vue_this = this;
					//带时间参数,
					axios.get('testjson/data2.json', {
						msgLastTime: _vue_this.msgLastTime
					})
					.then(function (response) {
						//   // 服务端返回的状态信息
						if(response.status==200){
							// console.log(1);
							//   // 服务端返回的数据
							if(response.data.length==0){
								layer.msg("没有更多，请修改查找条件！");
								return;
							};	
							_vue_this.appendMsgWin(response.data);
						}else {
							layer.msg("获取信息失败！"+response.statusText);
							return;
						}
					})
					.catch(function (error) {
						console.log(error);
					});
				},

				// 发送数据
				sendMsg:function(){
					
					var res={code:0, msg:""};
					
					if(res.code){
						//成功
						// 清空textarea内容,追加到window
					}else{
						//不成功,
						layer.msg(res.msg);
					}
				},
				delMsg:function(){
					
				},
				appengBlackList:function(){
					
				}
			},
			mounted:function(){
				//请求数据,更新页面,定时器
				this.intervalid1 =setInterval(this.upMsgWin(), 1000);
			},
			beforeDestroy:function(){
				clearInterval(this.intervalid1);
			}
		});
	</script>
</html>
